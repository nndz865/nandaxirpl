<!doctype html>
<html lang="id">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Pisah Guyon Waton — Koleksi Lagu</title>
    <style>
        :root{--bg:#0f1724;--card:#0b1220;--muted:#9aa6bd;--accent:#86efac}
        html,body{height:100%;margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial}
        body{background:linear-gradient(180deg,#071428 0%, #0b1220 60%);color:#e6eef8;display:flex;align-items:flex-start;justify-content:center;padding:28px}
        .wrap{max-width:900px;width:100%;background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);border-radius:12px;padding:20px;box-shadow:0 6px 30px rgba(2,6,23,.6)}
        header{display:flex;align-items:center;gap:14px}
        h1{font-size:20px;margin:0}
        p.lead{color:var(--muted);margin:6px 0 18px;font-size:13px}
        .grid{display:grid;grid-template-columns:1fr 320px;gap:16px}
        .card{background:var(--card);padding:14px;border-radius:10px}
        .controls{display:flex;gap:8px;flex-wrap:wrap}
        input[type="file"]{color:transparent}
        textarea{width:100%;height:220px;background:#021322;border:1px solid rgba(255,255,255,.04);color:#cfe8ff;padding:10px;border-radius:8px;resize:vertical;font-family:inherit}
        button{background:var(--accent);border:none;padding:8px 10px;border-radius:8px;color:#022;cursor:pointer;font-weight:600}
        .list{max-height:320px;overflow:auto;padding:8px;border-radius:8px;background:linear-gradient(180deg,rgba(255,255,255,.01),transparent)}
        .line{padding:6px 8px;border-radius:6px;margin-bottom:6px;cursor:pointer;color:var(--muted);display:flex;justify-content:space-between;gap:8px}
        .line:hover{background:rgba(255,255,255,.02);color:#e6faff}
        .time{font-size:12px;color:#7ee2a7}
        small.note{color:var(--muted);display:block;margin-top:8px}
        @media(max-width:820px){.grid{grid-template-columns:1fr}}
    </style>
</head>
<body>
    <main class="wrap" role="main">
        <header>
            <svg width="36" height="36" viewBox="0 0 24 24" fill="none" aria-hidden>
                <rect x="3" y="3" width="18" height="18" rx="4" fill="#86efac" opacity=".12"/>
                <path d="M7 8v8a1 1 0 0 0 1 1h1" stroke="#86efac" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M15 8v8a1 1 0 0 1-1 1h-1" stroke="#86efac" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <div>
                <h1>Pisah Guyon Waton — Halaman Lagu</h1>
                <p class="lead">Simpan audio lokal, catat lirik/akord, dan buat timestamp sederhana. Jangan tempel lirik penuh yang dilindungi hak cipta; gunakan ringkasan atau tautan jika perlu.</p>
            </div>
        </header>

        <section class="grid" aria-label="konten">
            <div class="card">
                <div style="display:flex;align-items:center;gap:12px;margin-bottom:12px">
                    <audio id="player" controls preload="metadata" style="width:100%">
                        <source src="pisah-guyon-waton.mp3" type="audio/mpeg">
                        Your browser does not support the audio element.
                    </audio>
                </div>

                <div class="controls" style="margin-bottom:12px">
                    <label style="display:inline-block">
                        <input id="audioFile" type="file" accept="audio/*">
                        <button type="button" id="loadLocal">Muat audio lokal</button>
                    </label>
                    <button id="playPause">Play/Pause</button>
                    <button id="rewind">⟲ -5s</button>
                    <button id="forward">+5s ⟳</button>
                </div>

                <div style="display:flex;gap:8px;align-items:center;margin-bottom:8px">
                    <button id="parse">Parse Lirik → Garis</button>
                    <button id="exportTxt">Simpan Lirik (.txt)</button>
                    <button id="clear">Bersihkan</button>
                </div>

                <small class="note">Klik baris lirik untuk menyimpan timestamp saat ini pada baris tersebut (berguna untuk latihan atau karaoke lokal).</small>
            </div>

            <aside class="card">
                <div style="margin-bottom:8px">
                    <strong>Lirik / Akord</strong>
                </div>
                <textarea id="lyrics" placeholder="Tempel lirik atau akord di sini. Untuk materi berhak cipta, cukup simpan ringkasan atau tautan ke sumber."></textarea>
                <div style="height:12px"></div>
                <div class="list" id="lines" aria-live="polite" title="Klik baris untuk menandai waktu">
                    <!-- Garis lirik akan diparsing di sini -->
                </div>
            </aside>
        </section>
    </main>

    <script>
        // Singkat, but functional: load local audio, parse lyrics into clickable lines, attach timestamps.
        const player = document.getElementById('player');
        const audioFile = document.getElementById('audioFile');
        const loadLocal = document.getElementById('loadLocal');
        const playPause = document.getElementById('playPause');
        const rewind = document.getElementById('rewind');
        const forward = document.getElementById('forward');
        const parseBtn = document.getElementById('parse');
        const linesEl = document.getElementById('lines');
        const lyrics = document.getElementById('lyrics');
        const exportTxt = document.getElementById('exportTxt');
        const clearBtn = document.getElementById('clear');

        loadLocal.addEventListener('click', () => audioFile.click());
        audioFile.addEventListener('change', e => {
            const f = e.target.files && e.target.files[0];
            if (!f) return;
            player.src = URL.createObjectURL(f);
            player.play().catch(()=>{});
        });

        playPause.addEventListener('click', () => {
            if (player.paused) player.play(); else player.pause();
        });
        rewind.addEventListener('click', () => player.currentTime = Math.max(0, player.currentTime - 5));
        forward.addEventListener('click', () => player.currentTime = Math.min(player.duration || Infinity, player.currentTime + 5));

        function secondsToTimestamp(s){
            if (!isFinite(s) || isNaN(s)) return '--:--';
            const mm = Math.floor(s/60).toString().padStart(2,'0');
            const ss = Math.floor(s%60).toString().padStart(2,'0');
            return mm + ':' + ss;
        }

        parseBtn.addEventListener('click', () => {
            linesEl.innerHTML = '';
            const raw = lyrics.value || '';
            const arr = raw.split(/\r?\n/).filter(Boolean);
            if (arr.length === 0){
                linesEl.innerHTML = '<div style="color:#7f97b0">Tidak ada baris untuk diparsing.</div>';
                return;
            }
            arr.forEach((ln, i) => {
                const div = document.createElement('div');
                div.className = 'line';
                div.dataset.index = i;
                div.innerHTML = `<span>${escapeHtml(ln)}</span><span class="time">--:--</span>`;
                div.addEventListener('click', () => {
                    div.querySelector('.time').textContent = secondsToTimestamp(player.currentTime);
                    div.dataset.time = player.currentTime.toString();
                });
                linesEl.appendChild(div);
            });
        });

        exportTxt.addEventListener('click', () => {
            const blob = new Blob([lyrics.value], {type:'text/plain;charset=utf-8'});
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = 'lirik-pisah-guyon-waton.txt';
            document.body.appendChild(a);
            a.click();
            URL.revokeObjectURL(a.href);
            a.remove();
        });

        clearBtn.addEventListener('click', () => {
            if (!confirm('Bersihkan lirik dan daftar baris?')) return;
            lyrics.value = '';
            linesEl.innerHTML = '';
        });

        // Small helper
        function escapeHtml(s){
            return s.replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'})[c]);
        }

    </script>
</body>
</html></label>